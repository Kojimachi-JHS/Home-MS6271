<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <title>TOTP認証</title>
  </head>
  <main>
    <h1>TOTP認証</h1>
    <input type="text" id="code" placeholder="TOTPコード">
    <button type="button" id="submit">認証</button>

    <script>
      const code = document.querySelector("input[name='code']").value;
      const secret = "YOUR_SECRET_KEY";
      const interval = 30;

      const generateCode = () => {
        const time = Math.floor(new Date().getTime() / interval);
        return sha256(secret + time).slice(-8);
      };

      const checkCode = (code) => {
        return code === generateCode();
      };

      document.querySelector("input[type='submit']").addEventListener("click", () => {
        if (checkCode(code)) {
          window.location.href = "/destination";
        } else {
          alert("TOTPコードが正しくありません。");
        }
      });
    </script>
  </main>
</html>